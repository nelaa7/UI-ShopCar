/*! @oneaudi/audi-core-application 8.0.2 - Mon, 14 Aug 2023 12:27:00 GMT
License information can be found in audi-core-application-tracking.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("core-tracking-objects"),require("core-utils")):"function"==typeof define&&define.amd?define("core-application-tracking",["core-tracking-objects","core-utils"],t):"object"==typeof exports?exports["core-application-tracking"]=t(require("core-tracking-objects"),require("core-utils")):e["core-application-tracking"]=t(e["core-tracking-objects"],e["core-utils"])}(self,((e,t)=>(()=>{"use strict";var r={525:t=>{t.exports=e},39:e=>{e.exports=t}},n={};function a(e){var t=n[e];if(void 0!==t)return t.exports;var c=n[e]={exports:{}};return r[e](c,c.exports,a),c.exports}a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var c={};return(()=>{a.r(c);var e=a(525);class t{constructor(){if(t._instance)return t._instance;this._registerAdditionalClickSelectors(),this._registerLayerCloseSelectors(),t._instance=this}_registerAdditionalClickSelectors(){e.clickEventService.registerClickSelector(".nm-layer .nm-button-cancel"),e.clickEventService.registerClickSelector(".nm-j-jslayer .nm-button-close"),e.clickEventService.registerClickSelector(".nm-layer .nm-button-close"),e.clickEventService.registerClickSelector(".nm-j-layer-close-button"),e.clickEventService.registerClickSelector(".nm-layerClose")}_registerLayerCloseSelectors(){e.clickEventObjectLayerClose.registerLayerCloseSelector(".nm-layer .nm-button-cancel"),e.clickEventObjectLayerClose.registerLayerCloseSelector(".nm-j-jslayer .nm-button-close"),e.clickEventObjectLayerClose.registerLayerCloseSelector(".nm-layer .nm-button-close"),e.clickEventObjectLayerClose.registerLayerCloseSelector(".nm-j-layer-close-button"),e.clickEventObjectLayerClose.registerLayerCloseSelector(".nm-layerClose")}}new t;class r{constructor(){if(r._instance)return r._instance;this._registerAdditionalClickSelectors(),this._registerLayerOpenSelectors(),r._instance=this}_registerAdditionalClickSelectors(){e.clickEventService.registerClickSelector(".nm-jslayerLink"),e.clickEventService.registerClickSelector(".nm-layerLink")}_registerLayerOpenSelectors(){e.clickEventObjectLayerOpen.registerLayerOpenSelector(".nm-jslayerLink"),e.clickEventObjectLayerOpen.registerLayerOpenSelector(".nm-layerLink")}}new r;class n{static getSearchTerm(){return n._getSearchTermGSA()||this._getSearchTermSiteSearch()}static _getSearchTermGSA(){return document.body.getAttribute("data-search-term")||""}static _getSearchTermSiteSearch(){return new URLSearchParams(window.location.search).get("q")||""}static isSearchResultPage(){return n.isSearchResultPageGSA()||n.isSearchResultPageSiteSearch()}static isSearchResultPageGSA(){return 0!==document.querySelectorAll(".gsa-search-result").length}static isSearchResultPageSiteSearch(){return 0!==document.querySelectorAll("site-search").length}}class s{constructor(){if(s._instance)return s._instance;e.clickEventService.register(s.getTrackingData),s._instance=this}static async getTrackingData(e){const t=e.currentTarget;if(!s._isPageNumberItem(t)&&!s._isNextPageItem(t)&&!s._isPreviousPageItem(t))return{};return{attributes:{componentName:"main search",pos:s._getPageNumber(t),value:n.getSearchTerm()},eventInfo:{eventAction:"navigation",eventName:"main search - more search results"}}}static _isPageNumberItem(e){return!!(e&&e.parentNode&&e.parentNode.parentNode&&e.parentNode.parentNode.classList)&&e.parentNode.parentNode.classList.contains("lists-pagination")}static _isPreviousPageItem(e){return!!(e&&e.parentNode&&e.parentNode.classList&&e.classList)&&(e.parentNode.classList.contains("navigation-pagination")&&e.classList.contains("prev"))}static _isNextPageItem(e){return!!(e&&e.parentNode&&e.parentNode.classList&&e.classList)&&(e.parentNode.classList.contains("navigation-pagination")&&e.classList.contains("next"))}static _getPageNumber(e){if(s._isPageNumberItem(e))return e.innerText;const t=s._getListPaginationSelection();return s._isNextPageItem(e)?t?(Number(t.innerText)+1).toString():"0":s._isPreviousPageItem(e)&&t?(Number(t.innerText)-1).toString():"0"}static _getListPaginationSelection(){return document.querySelector(".lists-pagination .is-selected a")}}new s;class i{constructor(){if(i._instance)return i._instance;e.clickEventService.register(i.getTrackingData),i._instance=this}static async getTrackingData(e){return e&&e.currentTarget&&e.currentTarget.classList&&e.currentTarget.classList.contains("audi-j-quick-search-result-tracking")?{attributes:{componentName:"main search",pos:i._getSearchResultPosition(e.currentTarget),value:i._getSearchTerm()},eventInfo:{eventName:"main search - quick search result click"}}:{}}static _getSearchTerm(){let e="";return document.querySelector("input.nm-su-input")&&(e=document.querySelector("input.nm-su-input").value),e}static _getSearchResultPosition(e){let t=1;if(!e)return t.toString();const r=e.closest("li");return r&&r.parentNode&&(t=[...r.parentNode.children].indexOf(r),t+=1),t.toString()}}new i;class o{constructor(){if(o._instance)return o._instance;e.clickEventService.register(o.getTrackingData),o._instance=this}static async getTrackingData(e){if(!o._isSearchAccess(e))return{};return{attributes:{pos:"",targetURL:"",value:""},eventInfo:{eventAction:"navigation",eventName:"main search - access"}}}static _isSearchAccess(e){return e&&e.currentTarget&&e.currentTarget.classList&&e.currentTarget.classList.contains("audi-j-search-access")&&e.currentTarget.parentElement&&e.currentTarget.parentElement.classList.contains("nm-header-overlay-is-open")}}new o;class l{static get ITEM_SELECTOR(){return".audi-j-search-result"}constructor(){if(l._instance)return l._instance;e.clickEventService.register(l.getTrackingData),l._instance=this}static async getTrackingData(e){if(!l._isSearchResultItem(e))return{};return{attributes:{pos:l._getSearchResultPosition(e),value:n.getSearchTerm()},eventInfo:{eventName:"main search - result click"}}}static _isSearchResultItem(e){return null!==e.currentTarget.closest(l.ITEM_SELECTOR)}static _getSearchResultPosition(e){const t=e.currentTarget.closest(l.ITEM_SELECTOR).getAttribute("data-tracking-pos");return t||"1"}}new l;class u{constructor(){if(u._instance)return u._instance;e.clickEventService.register(u.getData),u._instance=this}static async getData(t){if(!u._isSearchSubmitLink(t))return{};const r=e.ClickEventHelperDom.getTargetUrl(t),n="#search=",a=r.indexOf(n)+8;return{attributes:{componentName:"main search",value:r.substring(a)},eventInfo:{eventName:"main search - submit"}}}static _isSearchSubmitLink(t){const r=e.ClickEventHelperDom.getTargetClassList(t);return!!r&&r.contains("nm-j-tracking-search-submit")}}new u;var g=a(39);class m{static get POLL_TIME(){return"2000"}constructor(){if(m._instance)return m._instance;this.callBackFunction=this.getTrackingData.bind(this),e.searchService.register(this.callBackFunction),m._instance=this}async getTrackingData(){if(!n.isSearchResultPageGSA())return{};try{return await g.polling.wait(this._isBodyWithSearchParameters,m.POLL_TIME),{name:"main search",results:document.querySelector("body").getAttribute("data-search-results"),term:n.getSearchTerm()}}catch(e){return{}}}_isBodyWithSearchParameters(){return document.querySelector("body").hasAttribute("data-search-results")}}new m;class S{constructor(){if(S._instance)return S._instance;const t=this.getTrackingData.bind(this);e.searchService.register(t),S._instance=this}async getTrackingData(){return n.isSearchResultPageSiteSearch()?{name:"main search",results:"",term:n.getSearchTerm()}:{}}}new S;class h{constructor(){if(h._instance)return h._instance;e.stateEventService.register(h.getTrackingData),h._instance=this}static async getTrackingData(){if(!n.isSearchResultPage())return{};return{eventInfo:{eventName:"main search - results"}}}}new h})(),c})()));
//# sourceMappingURL=audi-core-application-tracking.js.map